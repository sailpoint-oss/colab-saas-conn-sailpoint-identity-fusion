{
    "name": "Identity Fusion NG",
    "description": "Identity Fusion NG is a connector that allows you to manage Identity Fusion accounts by generating unique identifiers, preventing duplicate identities through similarity matching, and merging account attributes from multiple authoritative sources.",
    "commands": [
        "std:test-connection",
        "std:account:list",
        "std:account:read",
        "std:account:enable",
        "std:account:disable",
        "std:account:create",
        "std:account:update",
        "std:account:discover-schema",
        "std:entitlement:list"
    ],
    "supportsCustomSchemas": true,
    "showDebugLoggingOption": true,
    "sourceConfigInitialValues": {
        "fusionFormExpirationDays": 7,
        "fusionAverageScore": 80,
        "provisioningTimeout": 300,
        "managedAccountsBatchSize": 50,
        "includeIdentities": true,
        "identityScopeQuery": "*",
        "correlateOnAggregation": true,
        "maxHistoryMessages": 10,
        "attributeMerge": "first",
        "enableQueue": true,
        "enableRetry": true,
        "maxRetries": 20,
        "requestsPerSecond": 8,
        "maxConcurrentRequests": 8,
        "taskResultRetries": 5,
        "taskResultWait": 1,
        "processingWait": 60,
        "retryDelay": 1000,
        "batchSize": 250,
        "externalLoggingLevel": "info",
        "proxyEnabled": false,
        "proxyUrl": "",
        "proxyPassword": "",
        "maxAttempts": 20,
        "digits": 1,
        "counterStart": 1,
        "case": "same",
        "expression": "#set($initial = $firstname.substring(0, 1))$initial$lastname",
        "useIncrementalCounter": false,
        "refresh": false,
        "trim": false,
        "force": false,
        "algorithm": "name-matcher",
        "enableBatching": true
    },
    "sourceConfig": [
        {
            "type": "menu",
            "label": "Connection Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Connection Settings",
                    "sectionHelpMessage": "<strong>Configure how this connector connects to Identity Security Cloud.</strong><br><br>Use <strong>Identity Security Cloud API URL</strong> to specify the base URL of your ISC tenant (for example, <code>https://tenant.api.identitynow.com</code>).<br><br>Provide the <strong>Personal Access Token ID</strong> and <strong>Personal Access Token Secret</strong> for an account that has the required API permissions (Sources, Identities, Accounts, Workflows/Forms). These values are used to authenticate all connector operations.",
                    "items": [
                        {
                            "key": "baseurl",
                            "label": "Identity Security Cloud API URL",
                            "type": "url",
                            "required": true,
                            "helpKey": "Base URL of your Identity Security Cloud tenant (format: https://<tenant>.api.identitynow.com)"
                        },
                        {
                            "key": "clientId",
                            "label": "Personal Access Token ID",
                            "type": "text",
                            "required": true,
                            "helpKey": "Client ID from your Personal Access Token. Must have required API permissions for sources, identities, accounts, workflows/forms"
                        },
                        {
                            "key": "clientSecret",
                            "label": "Personal Access Token secret",
                            "type": "secret",
                            "required": true,
                            "helpKey": "Client Secret from your Personal Access Token. Keep secure; rotate as needed"
                        }
                    ]
                }
            ]
        },
        {
            "type": "menu",
            "label": "Source Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Scope",
                    "sectionHelpMessage": "<strong>Define which identities are in scope for processing.</strong><br><br>Use <strong>Include identities in the scope?</strong> to include identities in addition to managed accounts from configured sources. This is useful for identity-only attribute generation or to define the baseline for deduplication.<br><br>Use <strong>Identity Scope Query</strong> to limit which identities are evaluated. This uses ISC search syntax (e.g. <code>attributes.cloudLifecycleState:active</code>, <code>source.name:\"Workday\"</code>). Only identities matching this query are considered.",
                    "items": [
                        {
                            "key": "includeIdentities",
                            "label": "Include identities in the scope?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Include identities in addition to managed accounts from configured sources. Enable for identity-only attribute generation or to define the baseline for deduplication"
                        },
                        {
                            "key": "identityScopeQuery",
                            "label": "Identity Scope Query",
                            "type": "text",
                            "required": true,
                            "parentKey": "includeIdentities",
                            "parentValue": "true",
                            "helpKey": "Search/filter query to limit which identities are evaluated. Uses ISC search syntax; examples: * (all), attributes.cloudLifecycleState:active, source.name:\"Workday\""
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Sources",
                    "sectionHelpMessage": "<strong>Select the authoritative account sources that feed Identity Fusion.</strong><br><br>Use <strong>Authoritative Account Sources</strong> to configure sources whose accounts will be merged. For each source:<br><ul><li><strong>Source name:</strong> Must match the ISC source name exactly.</li><li><strong>Force aggregation:</strong> Trigger fresh aggregation before processing (ensures current data but increases runtime).</li><li><strong>Account filter:</strong> Limit which accounts are processed (uses ISC search syntax).</li><li><strong>Aggregation batch size:</strong> Limit accounts per run (useful for initial loading).</li></ul><br>Global settings control retries and wait times for aggregation task polling.",
                    "items": [
                        {
                            "key": "sources",
                            "label": "Authoritative account sources",
                            "titleKey": "name",
                            "subtitleKey": "accountFilter",
                            "dragNDropEnabled": true,
                            "deleteButton": true,
                            "editButton": true,
                            "addButton": true,
                            "copyButton": true,
                            "buttonLabel": "Add source",
                            "type": "cardList",
                            "required": false,
                            "subMenus": [
                                {
                                    "label": "Source Configuration",
                                    "items": [
                                        {
                                            "key": "name",
                                            "label": "Source name",
                                            "type": "text",
                                            "required": true,
                                            "helpKey": "Name of the authoritative account source. Must match the source name in ISC exactly (case-sensitive)"
                                        },
                                        {
                                            "key": "enabled",
                                            "label": "Enabled",
                                            "type": "toggle",
                                            "value": "true",
                                            "required": false,
                                            "helpKey": "Include this source in processing. Disabled sources are excluded from aggregation and fusion entirely"
                                        },
                                        {
                                            "key": "forceAggregation",
                                            "label": "Force aggregation before processing?",
                                            "type": "toggle",
                                            "required": false,
                                            "helpKey": "Trigger a fresh aggregation of this source before each run. Ensures current data but increases runtime"
                                        },
                                        {
                                            "key": "accountFilter",
                                            "label": "Account filter",
                                            "type": "text",
                                            "required": false,
                                            "helpKey": "Filter query to limit which accounts from this source are processed. Uses ISC search syntax; example: attributes.department:\"Engineering\""
                                        },
                                        {
                                            "key": "accountLimit",
                                            "label": "Aggregation batch size",
                                            "type": "number",
                                            "required": false,
                                            "helpKey": "Maximum accounts to aggregate per run. Leave empty for all accounts; useful for initial loading of large datasets"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "key": "taskResultRetries",
                            "label": "Aggregation task result retries",
                            "type": "number",
                            "required": false,
                            "min": "0",
                            "helpKey": "Number of times to poll aggregation task status. Default: 5; applies to all sources with force aggregation enabled"
                        },
                        {
                            "key": "taskResultWait",
                            "label": "Aggregation task result wait time (seconds)",
                            "type": "number",
                            "required": false,
                            "min": "0",
                            "helpKey": "Wait time between aggregation task status checks (seconds). Default: 1; applies to all sources with force aggregation enabled"
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Processing Control",
                    "sectionHelpMessage": "<strong>Control how Identity Fusion accounts are maintained.</strong><br><br><ul><li><strong>Maximum history messages:</strong> Limit history entries per account (default: 10).</li><li><strong>Delete accounts...:</strong> Remove Fusion account when all source accounts are gone.</li><li><strong>Correlate missing...:</strong> Attempt to correlate new/missing source accounts each run (default: true).</li><li><strong>Force attribute refresh...:</strong> Force Normal-type attributes to refresh every run (expensive).</li><li><strong>Skip accounts...:</strong> Skip processing if native identity attribute is missing.</li></ul>",
                    "items": [
                        {
                            "key": "maxHistoryMessages",
                            "label": "Maximum history messages",
                            "type": "number",
                            "required": false,
                            "min": "1",
                            "helpKey": "Maximum history entries retained per Fusion account. Default: 10; older entries are discarded"
                        },
                        {
                            "key": "deleteEmpty",
                            "label": "Delete accounts with no authoritative accounts left?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Remove Fusion accounts when all contributing source accounts are removed. Useful for automated cleanup when users leave"
                        },
                        {
                            "key": "correlateOnAggregation",
                            "label": "Correlate missing source accounts on aggregation?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Attempt to correlate new or previously missing source accounts each run. Default: true; helps with incremental correlation"
                        },
                        {
                            "key": "forceAttributeRefresh",
                            "label": "Force attribute refresh on each aggregation?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Force Normal-type attributes to refresh every run. Unique attributes are only computed on creation/activation. Can be expensive"
                        },
                        {
                            "key": "skipAccountsWithMissingId",
                            "label": "Skip accounts with missing unique ID?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Skip processing accounts without a fusion identity attribute value. Skipped accounts are logged for review"
                        }
                    ]
                }
            ]
        },
        {
            "type": "menu",
            "label": "Attribute Mapping Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Attribute Mapping Definitions",
                    "sectionHelpMessage": "<strong>Map and merge source attributes into the Fusion account.</strong><br><br><strong>Default attribute merge:</strong> Global strategy for combining values (First found, Keep a list, Concatenate).<br><br><strong>Attribute Mapping:</strong> Configure per-attribute rules.<br><ul><li><strong>New attribute:</strong> Name on Fusion account.</li><li><strong>Existing attributes:</strong> Source attributes to map.</li><li><strong>Merge override:</strong> Override global strategy for this attribute (includes \"Source name\" to prefer a specific source).</li></ul>",
                    "items": [
                        {
                            "key": "attributeMerge",
                            "label": "Default attribute merge from multiple sources",
                            "type": "radio",
                            "required": true,
                            "helpKey": "Default method for combining values from different sources. Options: First found (by source order), Keep a list (array), Concatenate (string [a] [b])",
                            "options": [
                                {
                                    "label": "First found",
                                    "value": "first"
                                },
                                {
                                    "label": "Keep a list of values",
                                    "value": "list"
                                },
                                {
                                    "label": "Concatenate different values ([a] [b])",
                                    "value": "concatenate"
                                }
                            ]
                        },
                        {
                            "key": "attributeMaps",
                            "label": "Attribute Mapping",
                            "titleKey": "newAttribute",
                            "subtitleKey": "existingAttributes",
                            "dragNDropEnabled": true,
                            "deleteButton": true,
                            "editButton": true,
                            "addButton": true,
                            "copyButton": true,
                            "buttonLabel": "Add attribute mapping",
                            "type": "cardList",
                            "subMenus": [
                                {
                                    "label": "New Attribute Settings",
                                    "items": [
                                        {
                                            "key": "newAttribute",
                                            "label": "New attribute",
                                            "type": "text",
                                            "required": true,
                                            "helpKey": "Name of the attribute on the Fusion account. Will appear in the discovered schema"
                                        },
                                        {
                                            "key": "existingAttributes",
                                            "label": "Existing attributes",
                                            "type": "list",
                                            "required": true,
                                            "helpKey": "List of source attribute names that feed this attribute. Names must match source account schema (case-sensitive)"
                                        }
                                    ]
                                },
                                {
                                    "label": "Attribute Merging Settings",
                                    "items": [
                                        {
                                            "key": "attributeMerge",
                                            "label": "Default attribute merge from multiple sources",
                                            "type": "radio",
                                            "required": true,
                                            "helpKey": "Override default merge for this mapping. Adds \"Source name\" option to use value from a specific authoritative source",
                                            "options": [
                                                {
                                                    "label": "First found",
                                                    "value": "first"
                                                },
                                                {
                                                    "label": "Keep a list of values",
                                                    "value": "list"
                                                },
                                                {
                                                    "label": "Concatenate different values ([a] [b])",
                                                    "value": "concatenate"
                                                },
                                                {
                                                    "label": "Source name",
                                                    "value": "source"
                                                }
                                            ]
                                        },
                                        {
                                            "key": "source",
                                            "label": "Source name",
                                            "type": "text",
                                            "parentKey": "attributeMerge",
                                            "parentValue": "source",
                                            "required": true,
                                            "helpKey": "Specific source to use for this attribute. Takes precedence when multiple sources have values"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "menu",
            "label": "Attribute Definition Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Normal Attribute Definitions",
                    "sectionHelpMessage": "<strong>Generate computed attributes using Velocity templates.</strong><br><br>Normal attributes are recalculated on each aggregation when <em>Refresh</em> is enabled.<br><br><strong>Expression context:</strong> Mapped account attributes, <code>$Math</code>, <code>$Datefns</code>, <code>$AddressParse</code>, <code>$Normalize</code>.<br><strong>Options:</strong> Case transform, normalization, space removal, max length.",
                    "items": [
                        {
                            "key": "normalAttributeDefinitions",
                            "label": "Normal Attribute Definitions",
                            "titleKey": "expression",
                            "subtitleKey": "name",
                            "dragNDropEnabled": true,
                            "deleteButton": true,
                            "editButton": true,
                            "addButton": true,
                            "copyButton": true,
                            "buttonLabel": "New Normal Attribute Definition",
                            "type": "cardList",
                            "helpKey": "Add definitions to build computed attributes",
                            "subMenus": [
                                {
                                    "label": "Attribute Definition",
                                    "items": [
                                        {
                                            "key": "name",
                                            "label": "Attribute Name",
                                            "type": "text",
                                            "required": true,
                                            "helpKey": "Name of the account attribute to generate. Will appear in the discovered schema"
                                        },
                                        {
                                            "key": "expression",
                                            "label": "Apache Velocity expression",
                                            "type": "textarea",
                                            "required": true,
                                            "helpKey": "Template to generate value. Context: mapped attributes, $Math, $Datefns, $AddressParse, $Normalize. Example: #set($i=$firstname.substring(0, 1))$i$lastname"
                                        },
                                        {
                                            "key": "refresh",
                                            "label": "Refresh on each aggregation?",
                                            "type": "toggle",
                                            "helpKey": "Recalculate value on every aggregation"
                                        }
                                    ]
                                },
                                {
                                    "label": "Transformations",
                                    "items": [
                                        {
                                            "key": "case",
                                            "label": "Case selection",
                                            "type": "select",
                                            "required": true,
                                            "helpKey": "Case transformation to apply",
                                            "options": [
                                                {
                                                    "label": "Do not change",
                                                    "value": "same"
                                                },
                                                {
                                                    "label": "Lower case",
                                                    "value": "lower"
                                                },
                                                {
                                                    "label": "Upper case",
                                                    "value": "upper"
                                                },
                                                {
                                                    "label": "Capitalize",
                                                    "value": "capitalize"
                                                }
                                            ]
                                        },
                                        {
                                            "key": "normalize",
                                            "label": "Normalize special characters?",
                                            "type": "toggle",
                                            "helpKey": "Remove special characters and quotes"
                                        },
                                        {
                                            "key": "spaces",
                                            "label": "Remove spaces?",
                                            "type": "toggle",
                                            "helpKey": "Remove all spaces from value"
                                        },
                                        {
                                            "key": "trim",
                                            "label": "Trim leading and trailing spaces?",
                                            "type": "toggle",
                                            "helpKey": "Remove leading and trailing whitespace from value"
                                        },
                                        {
                                            "key": "maxLength",
                                            "label": "Maximum length",
                                            "type": "number",
                                            "required": false,
                                            "min": "1",
                                            "helpKey": "Maximum length for generated value; truncates to this length"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Unique Attribute Definitions",
                    "sectionHelpMessage": "<strong>Generate unique attributes using Velocity templates with uniqueness enforcement.</strong><br><br>Unique attribute values are preserved once generated and only recalculated on account reset/enable.<br><br><strong>Expression context:</strong> Mapped account attributes, <code>$UUID</code> (auto-generated v4 UUID), <code>$counter</code> (incremental or collision-based), <code>$Math</code>, <code>$Datefns</code>, <code>$AddressParse</code>, <code>$Normalize</code>.<br><br><strong>Collision handling:</strong> On duplicate, the connector appends a disambiguation counter (<code>$counter</code>). Enable <em>Use incremental counter</em> for sequential numbering instead.<br><strong>UUID:</strong> Use <code>$UUID</code> in the expression for an auto-generated immutable UUID.<br><strong>Max attempts:</strong> Limits retries to prevent infinite loops.",
                    "items": [
                        {
                            "key": "maxAttempts",
                            "label": "Maximum attempts for unique attribute generation",
                            "type": "number",
                            "required": false,
                            "min": "1",
                            "helpKey": "Maximum attempts to generate a unique value before giving up. Default: 100; prevents infinite loops"
                        },
                        {
                            "key": "uniqueAttributeDefinitions",
                            "label": "Unique Attribute Definitions",
                            "titleKey": "expression",
                            "subtitleKey": "name",
                            "dragNDropEnabled": true,
                            "deleteButton": true,
                            "editButton": true,
                            "addButton": true,
                            "copyButton": true,
                            "buttonLabel": "New Unique Attribute Definition",
                            "type": "cardList",
                            "helpKey": "Add definitions to build unique attributes",
                            "subMenus": [
                                {
                                    "label": "Attribute Definition",
                                    "items": [
                                        {
                                            "key": "name",
                                            "label": "Attribute Name",
                                            "type": "text",
                                            "required": true,
                                            "helpKey": "Name of the unique account attribute to generate. Will appear in the discovered schema"
                                        },
                                        {
                                            "key": "expression",
                                            "label": "Apache Velocity expression",
                                            "type": "textarea",
                                            "required": true,
                                            "helpKey": "Template to generate value. Use $UUID for auto-generated UUID, $counter for counter values. Context: mapped attributes, $Math, $Datefns, $AddressParse, $Normalize. Example: #set($i=$firstname.substring(0, 1))$i$lastname$counter"
                                        },
                                        {
                                            "key": "digits",
                                            "label": "Minimum counter digits ($counter)",
                                            "type": "number",
                                            "required": true,
                                            "helpKey": "Minimum digits for counter (zero-padded). Example: 3 â†’ 001, 002"
                                        },
                                        {
                                            "key": "useIncrementalCounter",
                                            "label": "Use incremental counter?",
                                            "type": "toggle",
                                            "helpKey": "Use a persistent counter ($counter) that always increments instead of only incrementing on collision. Useful for sequential numbering (e.g. employee IDs)"
                                        },
                                        {
                                            "key": "counterStart",
                                            "label": "Counter start value",
                                            "type": "number",
                                            "parentKey": "useIncrementalCounter",
                                            "parentValue": "true",
                                            "required": true,
                                            "helpKey": "Starting value for the incremental counter. Example: 1, 1000"
                                        }
                                    ]
                                },
                                {
                                    "label": "Transformations",
                                    "items": [
                                        {
                                            "key": "case",
                                            "label": "Case selection",
                                            "type": "select",
                                            "required": true,
                                            "helpKey": "Case transformation to apply",
                                            "options": [
                                                {
                                                    "label": "Do not change",
                                                    "value": "same"
                                                },
                                                {
                                                    "label": "Lower case",
                                                    "value": "lower"
                                                },
                                                {
                                                    "label": "Upper case",
                                                    "value": "upper"
                                                },
                                                {
                                                    "label": "Capitalize",
                                                    "value": "capitalize"
                                                }
                                            ]
                                        },
                                        {
                                            "key": "normalize",
                                            "label": "Normalize special characters?",
                                            "type": "toggle",
                                            "helpKey": "Remove special characters and quotes"
                                        },
                                        {
                                            "key": "spaces",
                                            "label": "Remove spaces?",
                                            "type": "toggle",
                                            "helpKey": "Remove all spaces from value"
                                        },
                                        {
                                            "key": "trim",
                                            "label": "Trim leading and trailing spaces?",
                                            "type": "toggle",
                                            "helpKey": "Remove leading and trailing whitespace from value"
                                        },
                                        {
                                            "key": "maxLength",
                                            "label": "Maximum length",
                                            "type": "number",
                                            "required": false,
                                            "min": "1",
                                            "helpKey": "Maximum length for generated value; truncates to this length"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "menu",
            "label": "Fusion Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Matching Settings",
                    "sectionHelpMessage": "<strong>Configure duplicate identity detection.</strong><br><br><strong>Fusion attribute matches:</strong> Define attributes to compare.<br><ul><li><strong>Algorithm:</strong> Enhanced Name Matcher, Jaro-Winkler, LIG3, Dice, Double Metaphone.</li><li><strong>Score:</strong> Similarity threshold (0-100).</li><li><strong>Mandatory:</strong> Require this match?</li></ul><br><strong>Scoring mode:</strong> Use per-attribute thresholds (default) or single overall average score.<br><strong>Auto-correlate:</strong> Automatically merge precise matches without manual review.",
                    "items": [
                        {
                            "key": "matchingConfigs",
                            "label": "Fusion attribute matches",
                            "titleKey": "attribute",
                            "subtitleKey": "algorithm",
                            "dragNDropEnabled": true,
                            "deleteButton": true,
                            "editButton": true,
                            "addButton": true,
                            "copyButton": true,
                            "buttonLabel": "Add attribute match",
                            "type": "cardList",
                            "subMenus": [
                                {
                                    "label": "Attribute match configuration",
                                    "items": [
                                        {
                                            "key": "attribute",
                                            "label": "Attribute",
                                            "type": "text",
                                            "required": true,
                                            "helpKey": "Identity attribute name to compare. Must exist on identities in scope"
                                        },
                                        {
                                            "key": "algorithm",
                                            "label": "Matching algorithm",
                                            "type": "select",
                                            "required": true,
                                            "helpKey": "Similarity algorithm. Enhanced Name Matcher (names), Jaro-Winkler (typos/short), LIG3 (advanced/intl), Dice (long text), Double Metaphone (phonetic)",
                                            "options": [
                                                {
                                                    "label": "Enhanced Name Matcher",
                                                    "value": "name-matcher",
                                                    "docLink": "https://github.com/craj/name-match",
                                                    "docLinkLabel": "Learn more about Enhanced Name Matcher"
                                                },
                                                {
                                                    "label": "Jaro-Winkler",
                                                    "value": "jaro-winkler",
                                                    "docLink": "https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance",
                                                    "docLinkLabel": "Learn more about Jaro-Winkler similarity"
                                                },
                                                {
                                                    "label": "LIG3",
                                                    "value": "lig3",
                                                    "docLink": "https://en.wikipedia.org/wiki/Levenshtein_distance",
                                                    "docLinkLabel": "Learn more about LIG3 (based on Levenshtein distance)"
                                                },
                                                {
                                                    "label": "Dice",
                                                    "value": "dice",
                                                    "docLink": "https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient",
                                                    "docLinkLabel": "Learn more about Dice coefficient"
                                                },
                                                {
                                                    "label": "Double Metaphone",
                                                    "value": "double-metaphone",
                                                    "docLink": "https://en.wikipedia.org/wiki/Metaphone",
                                                    "docLinkLabel": "Learn more about Double Metaphone algorithm"
                                                },
                                                {
                                                    "label": "Custom Algorithm (from SaaS customizer)",
                                                    "value": "custom"
                                                }
                                            ]
                                        },
                                        {
                                            "key": "fusionScore",
                                            "label": "Similarity score [0-100]",
                                            "type": "number",
                                            "required": true,
                                            "helpKey": "Minimum similarity score (0-100). Required when not using overall score mode. If mandatory, score must be >= threshold"
                                        },
                                        {
                                            "key": "mandatory",
                                            "label": "Mandatory match?",
                                            "type": "toggle",
                                            "required": false,
                                            "helpKey": "Require this attribute to match? If No, all attributes are treated as mandatory if none are marked mandatory"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "key": "fusionUseAverageScore",
                            "label": "Use overall fusion similarity score for all attributes?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Use single overall score instead of per-attribute thresholds? When enabled, only the overall (average) threshold must be met"
                        },
                        {
                            "key": "fusionAverageScore",
                            "label": "Similarity score [0-100]",
                            "parentKey": "fusionUseAverageScore",
                            "parentValue": "true",
                            "type": "number",
                            "required": true,
                            "helpKey": "Minimum overall similarity score for auto-correlation. Only used when \"Use overall fusion similarity score\" is enabled"
                        },
                        {
                            "key": "fusionMergingIdentical",
                            "label": "Automatically correlate if identical?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Auto-merge when attributes meet criteria without manual review? Use when confident in algorithm and thresholds"
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Review Settings",
                    "sectionHelpMessage": "<strong>Configure manual review for potential duplicates.</strong><br><br><ul><li><strong>Form attributes:</strong> Identity attributes shown to reviewers (e.g. name, email, department).</li><li><strong>Expiration:</strong> Days before review form expires (default: 7).</li><li><strong>Global reviewer:</strong> Add source owner as reviewer to all forms (ensures assignment).</li><li><strong>Report:</strong> Email report to owner after aggregation.</li></ul>",
                    "items": [
                        {
                            "key": "fusionFormAttributes",
                            "label": "List of Fusion account attributes to include in form",
                            "type": "list",
                            "required": false,
                            "helpKey": "Attributes shown on manual review form. Helps reviewers decide; examples: name, email, department"
                        },
                        {
                            "key": "fusionFormExpirationDays",
                            "label": "Manual review expiration days",
                            "type": "number",
                            "required": true,
                            "helpKey": "Days before review form expires. Default: 7; ensures timely resolution"
                        },
                        {
                            "key": "fusionOwnerIsGlobalReviewer",
                            "label": "Owner is global reviewer?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Add Fusion source owner as reviewer to all forms? Ensures at least one reviewer is always assigned"
                        },
                        {
                            "key": "fusionReportOnAggregation",
                            "label": "Send report to owner on aggregation?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Email report to owner after each aggregation? Includes potential duplicates and processing summary"
                        }
                    ]
                }
            ]
        },
        {
            "type": "menu",
            "label": "Advanced Settings",
            "items": [
                {
                    "type": "section",
                    "sectionTitle": "Developer Settings",
                    "sectionHelpMessage": "<strong>Advanced options for troubleshooting.</strong><br><br><ul><li><strong>Reset accounts:</strong> Force rebuild from scratch (Caution in production).</li><li><strong>Concurrency check:</strong> Prevent concurrent aggregations (Default: true).</li><li><strong>External logging:</strong> Send logs to external service (Splunk, etc.) for monitoring.</li></ul>",
                    "items": [
                        {
                            "key": "reset",
                            "label": "Reset accounts?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Force rebuild of all Fusion accounts from scratch on next run. Use with caution in production; disable after one run"
                        },
                        {
                            "key": "managedAccountsBatchSize",
                            "label": "Managed accounts batch size",
                            "type": "number",
                            "required": false,
                            "helpKey": "Number of uncorrelated managed accounts to process concurrently during deduplication. Lower values (e.g. 25) reduce peak memory usage; higher values (e.g. 50) may improve throughput. Default: 50."
                        },
                        {
                            "key": "concurrencyCheckEnabled",
                            "label": "Enable concurrency check?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Prevent concurrent account aggregations. Default: true. Auto-resets locked state if found"
                        },
                        {
                            "key": "externalLoggingEnabled",
                            "label": "Enable external logging?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Send connector logs to external endpoint. For centralized monitoring"
                        },
                        {
                            "key": "externalLoggingUrl",
                            "label": "External logging URL",
                            "type": "url",
                            "required": false,
                            "parentKey": "externalLoggingEnabled",
                            "parentValue": "true",
                            "helpKey": "URL endpoint for the external logging service"
                        },
                        {
                            "key": "externalLoggingLevel",
                            "label": "External logging level",
                            "type": "radio",
                            "required": false,
                            "parentKey": "externalLoggingEnabled",
                            "parentValue": "true",
                            "helpKey": "Minimum log level to send to external logging service (Error, Warn, Info, or Debug)",
                            "options": [
                                {
                                    "label": "Error",
                                    "value": "error"
                                },
                                {
                                    "label": "Warn",
                                    "value": "warn"
                                },
                                {
                                    "label": "Info",
                                    "value": "info"
                                },
                                {
                                    "label": "Debug",
                                    "value": "debug"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Advanced Connection Settings",
                    "sectionHelpMessage": "<strong>Fine-tune API and queue behavior.</strong><br><br><ul><li><strong>Provisioning timeout:</strong> Max wait for operations (default: 300s).</li><li><strong>Queue:</strong> Enable rate limiting and concurrency control.</li><li><strong>Retry:</strong> Auto-retry failed requests (recommended).</li><li><strong>Processing wait time:</strong> Keep-alive interval for long operations.</li><li><strong>Batching:</strong> Group requests for efficiency.</li></ul>",
                    "items": [
                        {
                            "key": "provisioningTimeout",
                            "label": "Provisioning timeout (seconds)",
                            "type": "number",
                            "required": true,
                            "helpKey": "Maximum wait time for provisioning operations. Default: 300; increase for large batches or slow APIs"
                        },
                        {
                            "key": "enableQueue",
                            "label": "Enable queue?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Enable queue management for API requests. Enables rate limiting and concurrency control"
                        },
                        {
                            "key": "maxConcurrentRequests",
                            "label": "Maximum concurrent requests",
                            "type": "number",
                            "required": false,
                            "min": "1",
                            "max": "10",
                            "parentKey": "enableQueue",
                            "parentValue": "true",
                            "helpKey": "Maximum simultaneous API requests. Default: 10; adjust based on API capacity"
                        },
                        {
                            "key": "requestsPerSecond",
                            "label": "Requests per second",
                            "type": "number",
                            "required": false,
                            "min": "1",
                            "max": "12",
                            "parentKey": "enableQueue",
                            "parentValue": "true",
                            "helpKey": "Maximum API requests per second (throttling). Default: 10; adjust based on API capacity"
                        },
                        {
                            "key": "enableRetry",
                            "label": "Enable retry?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Enable automatic retry for failed API requests. Recommended for production"
                        },
                        {
                            "key": "maxRetries",
                            "label": "API request retries",
                            "type": "number",
                            "required": false,
                            "min": "0",
                            "max": "20",
                            "parentKey": "enableRetry",
                            "parentValue": "true",
                            "helpKey": "Maximum retry attempts for failed API requests. Default: 20"
                        },
                        {
                            "key": "processingWait",
                            "label": "Processing wait time (seconds)",
                            "type": "number",
                            "required": true,
                            "min": "0",
                            "helpKey": "Interval between keep-alive signals during long-running operations. Default: 60"
                        },
                        {
                            "key": "retryDelay",
                            "label": "Retry delay (milliseconds)",
                            "type": "number",
                            "required": true,
                            "min": "0",
                            "helpKey": "Base delay between retry attempts (ms). Default: 1000; uses Retry-After header if present"
                        },
                        {
                            "key": "enableBatching",
                            "label": "Enable batching?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Group requests in queue for better throughput. Can improve efficiency for bulk operations"
                        },
                        {
                            "key": "batchSize",
                            "label": "Batch size",
                            "type": "number",
                            "parentKey": "enableBatching",
                            "parentValue": "true",
                            "required": true,
                            "min": "1",
                            "max": "250",
                            "helpKey": "Requests per batch. Default: 250"
                        },
                        {
                            "key": "enablePriority",
                            "label": "Enable priority processing?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Use prioritization when processing the queue, allowing more important requests to be handled first (enabled by default when queue is enabled)"
                        }
                    ]
                },
                {
                    "type": "section",
                    "sectionTitle": "Proxy Settings",
                    "sectionHelpMessage": "<strong>Delegate processing to external server.</strong><br><br>Run connector logic on your own infrastructure.<br><ul><li><strong>Proxy URL:</strong> External endpoint.</li><li><strong>Proxy password:</strong> Secret for authentication (must match PROXY_PASSWORD env var on proxy).</li></ul>",
                    "items": [
                        {
                            "key": "proxyEnabled",
                            "label": "Enable proxy mode?",
                            "type": "toggle",
                            "required": false,
                            "helpKey": "Delegate all processing to external endpoint. For running connector logic on your own infrastructure"
                        },
                        {
                            "key": "proxyUrl",
                            "label": "Proxy URL",
                            "type": "url",
                            "required": false,
                            "parentKey": "proxyEnabled",
                            "parentValue": "true",
                            "helpKey": "URL of external proxy endpoint. Must accept POST with command type, input, and config"
                        },
                        {
                            "key": "proxyPassword",
                            "label": "Proxy password",
                            "type": "secret",
                            "required": true,
                            "parentKey": "proxyEnabled",
                            "parentValue": "true",
                            "helpKey": "Secret for proxy authentication. Set same value as PROXY_PASSWORD environment variable on proxy server"
                        }
                    ]
                }
            ]
        }
    ],
    "accountSchema": {
        "displayAttribute": "name",
        "identityAttribute": "id",
        "attributes": [
            {
                "name": "id",
                "description": "ID",
                "type": "string",
                "required": true
            },
            {
                "name": "name",
                "description": "Account name",
                "type": "string",
                "required": true
            },
            {
                "name": "history",
                "description": "History",
                "type": "string",
                "multi": true
            },
            {
                "name": "statuses",
                "description": "Statuses",
                "type": "string",
                "multi": true,
                "entitlement": true,
                "managed": false,
                "schemaObjectType": "status"
            },
            {
                "name": "actions",
                "description": "Actions",
                "type": "string",
                "multi": true,
                "entitlement": true,
                "managed": true,
                "schemaObjectType": "action"
            },
            {
                "name": "accounts",
                "description": "Source account IDs",
                "type": "string",
                "multi": true,
                "entitlement": false
            },
            {
                "name": "missing-accounts",
                "description": "Missing source account IDs",
                "type": "string",
                "multi": true,
                "entitlement": false
            },
            {
                "name": "reviews",
                "description": "Reviews",
                "type": "string",
                "multi": true,
                "entitlement": false
            },
            {
                "name": "sources",
                "description": "sources",
                "type": "string",
                "multi": false,
                "entitlement": false
            },
            {
                "name": "originSource",
                "description": "Origin source name (set on creation, immutable)",
                "type": "string",
                "multi": false,
                "entitlement": false
            }
        ]
    },
    "entitlementSchemas": [
        {
            "type": "status",
            "identityAttribute": "id",
            "displayAttribute": "name",
            "attributes": [
                {
                    "name": "id",
                    "type": "string",
                    "description": "id"
                },
                {
                    "name": "name",
                    "type": "string",
                    "description": "name"
                },
                {
                    "name": "description",
                    "type": "string",
                    "description": "description"
                }
            ]
        },
        {
            "type": "action",
            "identityAttribute": "id",
            "displayAttribute": "name",
            "attributes": [
                {
                    "name": "id",
                    "type": "string",
                    "description": "id"
                },
                {
                    "name": "name",
                    "type": "string",
                    "description": "name"
                },
                {
                    "name": "description",
                    "type": "string",
                    "description": "description"
                }
            ]
        }
    ],
    "accountCreateTemplate": {
        "fields": [
            {
                "key": "name",
                "label": "name",
                "type": "string",
                "required": true,
                "initialValue": {
                    "type": "static",
                    "attributes": {
                        "value": "$identity.getName()"
                    }
                }
            }
        ]
    }
}